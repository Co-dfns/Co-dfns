:Namespace t0023
 
 v01←{~0∊0 1∊⍨⍵}
 vrr←{~0∊0=11○⍵}
 rho←{⍺(⍴⍤1 ¯1)⍵}
 mta←{(0⌷⍺)⍪(1⌷⍺)⍪(2⌷⍺)⍪3↓⍵}
 bas←{65536|⊃⍵}
 zer←{0=⌈⌿2↓⍵}
 ful←{(bas⍵)⍪1↓⍵}
 isr←{=∘|⍨⊃⍵}     
 isn←{2⌷⍵}
 zer←{∧⌿0=3↓⍵}
 top←{+⌿∧⍀0=3↓⍵}
 ovr←{(top⍵)+1⌷⍵}
 pla0←{¯3+≢⍵}
 pla1←{(3↑⍵)⍪(-⍺)↑3↓⍵}
 pla2←{k←0⌊(top⍵)+⍺+3-≢⍵ ⋄ (0⌷⍵)⍪(k+1⌷⍵)⍪(2⌷⍵)⍪(-⍺)↑k⊖3↓⍵}
 mov←{k←(3-≢⍵)⌈(¯3+≢⍵)⌊⍺-1⌷⍵ ⋄ (0⌷⍵)⍪⍺⍪(2⌷⍵)⍪k⊖(3↓⍵)×⍤¯1⊢k{(⍵∘.≥⍺)∧⍺∘.≤⍨⌽-⍵}⍳¯3+≢⍵}
 sg0←{(3↓⍵)×⍤¯1 15×.5-2⌷⍵}
 sg1←{b←bas ⍵ ⋄ (2↑⍵)⍪(0≠(3⌷⍵)≠(2⌷⍵))⍪|(3↓⍵)-⍨¯1↓{(b×⍵)-1⊖⍵}(0≠3⌷⍵)∧⍤15 ¯1⊢⊖∨⍀⊖0<0⍪⍨3↓⍵}
 sg2←{b←bas ⍵ ⋄ (3↑⍵)⍪(3↓⍵)-¯1↓{(b×⍵)-1⊖⍵}(0≠3⌷⍵)⍪0⍪⍨¯1↓∧⍀(b-1)=3↓⍵}
 cry1←{b←bas ⍵ ⋄ f←{{(0⌷⍵)+1⊖1⌷⍵}(0,b)⊤⍵} ⋄ g←{(0⌈⍵)+⊖+⍀⊖(1-b)×0⌊⍵} ⋄ k←2+⌈b⍟pla0⍵
 (pla0⍵)pla2 sg2 (3↑⍵)⍪k↓f⍣k⊢(-k+≢⍵)↑g(≢⍵)↑3↓⍵}
 cat←{(⍪⍤¯1)⍵}
 rav←{(,⍤¯1)⍵}
 pic←{(⊃⍤¯1)⍵}

:EndNamespace
